(function(){"use strict";function u(t){var e=Date.now().toString(16),n=Math.floor(4294967295*Math.random()).toString(16).padStart(8,"0");return(t||"")+e+n}function s(t,e){try{return t.getItem(e)}catch{return null}}function p(t,e,n){try{t.setItem(e,n)}catch{}}var d=document.currentScript;d instanceof HTMLScriptElement||(d=document.querySelector("script[data-site-id]"));if(!(d instanceof HTMLScriptElement))return;var v=d.getAttribute("data-site-id"),m=d.getAttribute("data-api-url");if(!v||!m)return;var V="tempoo_vid",S="tempoo_sid";function f(){var t=s(localStorage,V)||s(sessionStorage,V);return t||(t=u("v-"),p(localStorage,V,t)),t}function y(){var t=s(sessionStorage,S);return t||(t=u("s-"),p(sessionStorage,S,t)),t}function h(){return{siteId:v,type:"pageview",url:location.href,referrer:document.referrer||null,viewport:{width:window.innerWidth||0,height:window.innerHeight||0},visitorId:f(),sessionId:y(),userId:null,eventName:null,data:null,timestamp:(new Date).toISOString()}}function w(t){try{var e=JSON.stringify(t);if(navigator.sendBeacon){var n=new Blob([e],{type:"application/json"});navigator.sendBeacon(m,n)||fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:e,keepalive:!0})}else fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:e,keepalive:!0})}catch{}}function E(){var t=h();t.type="pageview",w(t)}function A(t,e){if(!t)return;var n=h();n.type="custom",n.eventName=t,e&&"object"==typeof e&&(n.data=e),w(n)}function C(t,e){if(!t)return;var n=h();n.type="identify",n.userId=t,n.data=e&&"object"==typeof e?e:null,w(n)}function D(t,e){var n=h();n.type="payment",n.eventName=t||null,n.data=e&&"object"==typeof e?e:null,w(n)}function L(t){if(!t)return;var e=t.getAttribute("data-tempoo-goal");if(!e)return;var n={};Array.prototype.slice.call(t.attributes).forEach(function(t){if(t.name.startsWith("data-tempoo-goal-")){var e=t.name.substring("data-tempoo-goal-".length);e&&(n[e.replace(/-/g,"_")]=t.value)}}),A(e,n)}function T(){var t=document.documentElement,e=document.body,n=Math.max(t.scrollHeight,e.scrollHeight,t.offsetHeight,e.offsetHeight,t.clientHeight,e.clientHeight),o=window.innerHeight||0,r=window.pageYOffset||document.documentElement.scrollTop||0,i=n-o;return i<=0?100:Math.min(100,Math.round(r/i*100))}function x(t,e){if(!t)return;var n=t.getAttribute("data-tempoo-scroll");if(!n)return;var o=t.getAttribute("data-tempoo-scroll-threshold"),r=t.getAttribute("data-tempoo-scroll-delay"),i=0,a=.5;if(null!==r){var l=parseInt(r,10);!isNaN(l)&&l>=0&&(i=l)}if(null!==o){var c=parseFloat(o);!isNaN(c)&&c>=0&&c<=1&&(a=c)}var d=function(){var e=T(),o={scroll_percentage:e,threshold:a,delay:i};Array.prototype.slice.call(t.attributes).forEach(function(e){if(e.name.startsWith("data-tempoo-scroll-")&&"data-tempoo-scroll-threshold"!==e.name&&"data-tempoo-scroll-delay"!==e.name){var n=e.name.substring("data-tempoo-scroll-".length);n&&(o[n.replace(/-/g,"_")]=e.value)}}),A(n,o),e.unobserve(t)};i>0?setTimeout(d,i):d()}function k(){if(!("IntersectionObserver"in window))return;var t=document.querySelectorAll("[data-tempoo-scroll]");if(0===t.length)return;var e=new Map;t.forEach(function(t){var n=t.getAttribute("data-tempoo-scroll-threshold"),o=.5;if(null!==n){var r=parseFloat(n);!isNaN(r)&&r>=0&&r<=1&&(o=r)}e.has(o)||e.set(o,[]),e.get(o).push(t)}),e.forEach(function(t,e){var n=new IntersectionObserver(function(t){t.forEach(function(t){t.isIntersecting&&x(t.target,n)})},{root:null,rootMargin:"0px",threshold:e});t.forEach(function(t){n.observe(t)})})}function N(t){if(!t||!t.href)return;try{var e=new URL(t.href);if("http:"!==e.protocol&&"https:"!==e.protocol)return;if(e.hostname===location.hostname)return;A("external_link",{url:t.href,text:(t.textContent||"").trim()})}catch{}}E(),document.addEventListener("click",function(t){var e=t.target;if(!e)return;var n=e.closest("[data-tempoo-goal]");n&&L(n);var o=e.closest("a");o&&N(o)}),document.addEventListener("keydown",function(t){if("Enter"!==t.key&&" "!==t.key)return;var e=t.target;if(!e)return;var n=e.closest("[data-tempoo-goal]");n&&L(n);var o=e.closest("a");o&&N(o)}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",k):k(),window.tempooAnalytics={track:A,identify:C,payment:D,pageview:E}})();